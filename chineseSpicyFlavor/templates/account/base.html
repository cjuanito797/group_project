<!DOCTYPE html>
{% load static %}
<!--suppress ALL -->
<html lang="en">
<title>Dashboard</title>
<head>

    <title>{% block title %}{% endblock %}</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <script
            src="https://code.jquery.com/jquery-3.4.1.min.js"
            integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
            crossorigin="anonymous"></script>

    <script text="javascript">
        setTimeout(fade_out, 3000);

        function fade_out() {
            $(".messages").fadeOut().empty();
        }

        $(".post-form")[0].reset(); // this is to reset the form
    </script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">

    <style>

        footer {
            background-color: #555;
            color: white;
            padding: 15px;
        }

        /* On small screens, set height to 'auto' for sidenav and grid */
        @media screen and (max-width: 767px) {

        }

        ul.messages {
            background-color: lightgreen;
            height: 40px;
            list-style: none;
            border-radius: 5px;
            border-color: lightgray;
            border-style: solid;
            top: 5%;
        }


        #ShoppingCart {
            position: absolute;
            top: 5%;
            left: 85%;
            background: transparent;
            text-align: center;
        }

        #productCt {
            position: relative;
            top: 3%;
            left: 15%;

        }

        .second_top {
            margin-top: 65px;
        }

        .top {
            height: 30px;
            width: 100%;
            margin-left: 0;
            background: rgb(189, 181, 181);
            position: absolute;
            top: 0;
            margin-bottom: 5px;
        }

        .top ul {
            width: auto;
            list-style-type: none;
            white-space: nowrap;
            overflow: hidden;
            margin-left: 5%;
            padding: 0;
        }

        .top li {
            float: left;
            margin-right: 2%;
            position: relative;
            overflow: hidden;
        }

        .top li a {
            display: block;
            color: white;
            text-align: center;
            padding: 3px;
            overflow: hidden;
            text-decoration: none;
        }

        .top li a:hover {
            background: #111;
        }

        .top ul li ul {
            margin-left: -0.2px;
            background: rgb(189, 181, 181);
            position: relative;
            display: none;
        }

        .top ul li ul li {
            float: none;
            text-align: center;
        }

        .top ul li:hover ul {
            display: block;
        }


        #mostRecentOrders {
            font-family: Arial, Helvetica, sans-serif;
            border-collapse: collapse;
            width: 100%;
        }

        #mostRecentOrders td, #mostRecentOrders th {
            border: 1px solid #ddd;
            padding: 8px;
        }

        #mostRecentOrders tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        #mostRecentOrders tr:hover {
            background-color: #ddd;
        }

        #mostRecentOrders th {
            padding-top: 12px;
            padding-bottom: 12px;
            text-align: left;
            background-color: #4CAF50;
            color: white;
        }

        #recentOrders {
            text-align: center;
            position: relative;
            margin-left: 25%;
            width: 750px;
            height: 250px;
            overflow-y: auto;
            width: 800px;

        }

        #favoriteItems {
            text-align: center;
            position: relative;
            margin-top: 20px;
            margin-left: 25%;
            width: 650px;
            height: 550px;
            overflow-y: auto;
            width: 800px;

        }

        #favoriteItems a {
            color: white;
            padding: 1em 2.5em;
            text-decoration: none;
            text-transform: uppercase;
            border-radius: 10px;
            font-family: bold;
            text-align: center;

        }

        #recommendations {
            text-align: center;
            position: relative;
            margin-top: 20px;
            margin-left: 25%;
            width: 750px;
            height: 550px;
            overflow-y: auto;
            width: 800px;

        }

        #picture {
            width: 100px;
            border-radius: 50%;
        }

        #picture:hover .overlay {
            opacity: 25;

        }

        .overlay {
            position: relative;
            top: 0;
            bottom: 0;
            left: 50%;
            right: 0;
            height: 100%;
            opacity: 0;
            transition: .5s ease;
            background-color: coral;
            text-align: center;
        }

        .overlay a {
            color: white;
            text-decoration: none;
            text-transform: uppercase;

        }

    </style>
</head>
<body>

<div class="top">
    <div style="text-align: center;">
        <ul>
            <li><a href="{% url 'chineseSpicyFlavor:covidWarning' %}">Home Page</a></li>
            <li><a href="#">ACCOUNT</a>
                <ul>

                    <li><a href="{% url 'chineseSpicyFlavor:edit' %}">Edit Account</a></li>

                </ul>
            </li>

            <li><a href="#">ADDRESSES</a>
                <ul>

                    <li><a href="{% url 'chineseSpicyFlavor:address_new' %}">Add an address</a></li>
                    <li><a href="{% url 'chineseSpicyFlavor:displayAddresses' %}">My Addresses</a></li>

                </ul>
            </li>

            <li><a href="#">MENU</a>
                <ul>
                    <li><a href="{% url 'chineseSpicyFlavor:product_list' %}">Foods</a></li>
                    <li><a href="{% url 'chineseSpicyFlavor:product_list' %}">Order Now</a></li>
                </ul>
            </li>

            <li><a href="#">ORDER</a>
                <ul>
                    <li><a href="{% url 'chineseSpicyFlavor:product_list' %}">Order Now</a></li>
                    <li><a href="{% url 'chineseSpicyFlavor:myOrders' %}">My Orders</a></li>

                </ul>
            </li>
            {% if user.is_staff %}
            <li><a href="#">ADMIN</a>
                <ul>
                    <li><a href="{% url 'chineseSpicyFlavor:ViewAllOrders' %}">Orders</a></li>
                    <li><a href="{% url 'chineseSpicyFlavor:Sales' %}">Sales</a></li>
                    <li><a href="{% url 'chineseSpicyFlavor:Customers' %}">Customers</a></li>
                </ul>
            </li>
            {% endif %}

            <ul>
                <li><a href="{% url 'chineseSpicyFlavor:logout' %}">Logout</a></li>
            </ul>
        </ul>
    </div>
</div>

<div class="second_top">
    <header>
        <ul class="messages">
            {% for message in messages %}
                <li class="{{ message.tags }}">
                    {{ message|safe }}
                    <a href="#" class="close">x</a>
                </li>
            {% endfor %}
        </ul>
    </header>


    <br>
    <div id="profilePic">
        <div id="picture">
            <a href="{% url "chineseSpicyFlavor:edit" %}">
                <img src="



                        {% if user.profile.image %}{{ user.profile.image.url }}{% else %}{% static "images/logo_home.PNG" %}{% endif %}"
                     alt="panda" width="200" height="200" style="border-radius: 50%">
            </a>
            <div class="overlay">
                <div class="text"><a href="{% url 'chineseSpicyFlavor:edit' %}">Edit</a></div>
            </div>
        </div>
        <h3>Welcome, {{ user.username }}</h3>
    </div>


    <div id="ShoppingCart">
        {% if  cart.get_total_price > 0 %}
            <a href="{% url "cart:cart_detail" %}">
                <img src="../../static/images/redBasket.png" width="200">
            </a>
            <p>Your Total ${{ cart.get_total_price }}</p>

        {% else %}
            <a href="{% url "chineseSpicyFlavor:product_list" %}">
                <img src="../../static/images/redBasket.png" width="200">
            </a>
            <p>Click Cart To Start Shopping Now</p>
        {% endif %}
    </div>
</div>

<div id="recentOrders">
    <h3>Your most recent orders at a glance</h3>
    {% if orders.count == 0 %}
        <p>It Looks Like You Don't Have Any Orders. Start Shopping Now!</p>

    {% else %}
        <table id="mostRecentOrders">
            <th>ID</th>
            <th>Order Date</th>
            <th>Delivery Address</th>
            <th>Order Total</th>
            <th colspan="3">Actions</th>

            {% for o in orders %}
                {% if forloop.counter < 5 %}

                    <tr>
                        <td>{{ o.id }}</td>
                        <td>{{ o.created }}</td>
                        {% ifnotequal o.address.pk None %}
                            <td>{{ o.address.streetNum }}<br>{{ o.address.city }},{{ o.address.state }}<br>{{ o.address.zipcode }}
                            </td>

                        {% endifnotequal %}
                        {% ifequal o.address.pk None %}
                            <td>Chinese Spicy Flavor</td>
                        {% endifequal %}
                        <td>{{ o.get_total_cost }}</td>
                        <td><a href="{% url 'chineseSpicyFlavor:OrderDetail' pk=o.pk %}"
                               class="btn btn-primary">Reciept</a>
                            {% if o.paid %}
                                <a href="{% url 'chineseSpicyFlavor:myOrders' %}" class="btn btn-primary"
                                   style="background-color:green;">Paid</a>
                            {% else %}
                                <a href="{% url 'payment:process' %}" class="btn btn-primary"
                                   style="background-color: red">Pay</a>

                            {% endif %}

                            <a href="{% url 'chineseSpicyFlavor:OrderDelete' pk=o.pk %}"
                               onclick="return confirm('Are you sure you want to delete?')"
                               class="btn btn-danger">Delete</a>
                        </td>
                    </tr>
                {% endif %}
            {% endfor %}
        </table>
    {% endif %}
</div>

<div id="favoriteItems">
    <h3>Your most liked items</h3>
    {% if orders.count == 0 %}
        <h3>You have not ordered any orders yet. </h3>
        <a href="{% url 'chineseSpicyFlavor:product_list' %}" style="background-color: coral;">Order Now</a>

    {% else %}
        {% for oi in mostLiked|dictsort:'product.name' %}
            {% ifchanged %}
                <h3>{{ oi.product.name }}</h3>

                {% with product=item.product %}
                    <a href="{{ oi.product.get_absolute_url }}">
                        <img src="

                                {% if oi.product.image %}{{ oi.product.image.url }}{% else %}{% static "img/no_image.png" %}{% endif %}"
                             alt="" style="border-radius: 50%; width: 200px; height:200px;">
                    </a>
                {% endwith %}
            {% endifchanged %}
        {% endfor %}
    {% endif %}
</div>

<div id="recommendations">
    <h3>We think you would like these!</h3>
    {% if orders.count == 0 %}
        <h3>Bummer. No Orders It Seems</h3>
        <img src="../../static/images/sadPanda.jpg">

    {% else %}
        {% for ri in random_items %}
            <h3>{{ ri.name }}</h3>
            {% with product=item.product %}

                <a href="{{ ri.get_absolute_url }}">
                    <img src="
                                {% if ri.image %}{{ ri.image.url }}{% else %}{% static "img/no_image.png" %}{% endif %}"
                         alt="" style="border-radius: 50%; width: 200px; height:200px;">
                </a>
            {% endwith %}
        {% endfor %}
    {% endif %}
</div>
</body>
</html>

